import pytest
from curvepy.de_caes import de_caes, parallel_decaes_unblossomed
import numpy as np

cases_de_caes = [

    ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.0], [0.0]], 0.0)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.2688614540466392], [0.5925925925925926]], 0.1111111111111111)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.9657064471879285], [1.037037037037037]], 0.2222222222222222)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.925925925925926], [1.3333333333333335]], 0.3333333333333333)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.9849108367626886], [1.4814814814814814]], 0.4444444444444444)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.9780521262002746], [1.4814814814814814]], 0.5555555555555556)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.7407407407407405], [1.3333333333333335]], 0.6666666666666666)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.108367626886145], [1.0370370370370374]], 0.7777777777777777)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.916323731138546], [0.5925925925925928]], 0.8888888888888888)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.0], [0.0]], 1.0)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.0], [0.0]], 0.0)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.1111111111111111], [0.19753086419753085]], 0.1111111111111111)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.2222222222222222], [0.345679012345679]], 0.2222222222222222)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.33333333333333337], [0.4444444444444445]], 0.3333333333333333)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.4444444444444444], [0.49382716049382713]], 0.4444444444444444)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.5555555555555556], [0.49382716049382713]], 0.5555555555555556)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.6666666666666666], [0.4444444444444445]], 0.6666666666666666)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.7777777777777777], [0.3456790123456791]], 0.7777777777777777)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[0.8888888888888888], [0.19753086419753094]], 0.8888888888888888)
    , ([[0.0, 0.5, 1.0], [0.0, 1.0, 0.0]], [[1.0], [0.0]], 1.0)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[-4.0], [3.0]], 0.0)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[-1.5294924554183813], [3.809632677945435]], 0.1111111111111111)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[0.641975308641975], [4.442463039170859]], 0.2222222222222222)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[2.6296296296296293], [4.876543209876544]], 0.3333333333333333)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[4.5157750342935525], [5.097241274196007]], 0.4444444444444444)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[6.3497942386831285], [5.097241274196007]], 0.5555555555555556)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[8.148148148148149], [4.876543209876544]], 0.6666666666666666)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[9.894375857338817], [4.442463039170859]], 0.7777777777777777)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[11.539094650205762], [3.8096326779454355]], 0.8888888888888888)
    , ([[-4, 2, 5, 10, 13], [3, 5, 6, 5, 3]], [[13.0], [3.0]], 1.0)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-23.0], [-3.0]], 0.0)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-21.506729815727414], [-4.72844022196255]],
       0.1111111111111111)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-19.778622650491776], [-5.728084585118575]],
       0.2222222222222222)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-17.912208504801104], [-5.995884773662554]],
       0.3333333333333333)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-15.970598805888145], [-5.763851490569979]],
       0.4444444444444444)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-13.992292653370741], [-5.360864141080572]],
       0.5555555555555556)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-11.998628257887521], [-5.106995884773664]],
       0.6666666666666666)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-9.999879572708918], [-5.2403540562357795]],
       0.7777777777777777)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-7.999998118323578], [-5.8764359543204225]],
       0.8888888888888888)
    , ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]], [[-6.0], [-7.0]], 1.0)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.0], [0.0]], 0.0)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.0024281175184144273], [0.05999387817569636]], 0.010101010101010102)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.00963002126148744], [0.1187633914906642]], 0.020202020202020204)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.02148203801096363], [0.1763085399449036]], 0.030303030303030304)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.03786049454858761], [0.23262932353841445]], 0.04040404040404041)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.05864171765610396], [0.2877257422711969]], 0.05050505050505051)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.08370203411525726], [0.3415977961432507]], 0.06060606060606061)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.11291777070779217], [0.39424548515457614]], 0.07070707070707072)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.1461652542154532], [0.445668809305173]], 0.08080808080808081)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.18332081141998496], [0.4958677685950413]], 0.09090909090909091)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.2242607691031322], [0.5448423630241813]], 0.10101010101010102)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.26886145404663925], [0.5925925925925927]], 0.11111111111111112)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.3169991930322509], [0.6391184573002755]], 0.12121212121212122)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.3685503128417118], [0.68441995714723]], 0.13131313131313133)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.4233911402567664], [0.7284970921334558]], 0.14141414141414144)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.4813980020591591], [0.7713498622589533]], 0.15151515151515152)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.5424472250306349], [0.812978267523722]], 0.16161616161616163)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.6064151359529384], [0.8533823079277626]], 0.17171717171717174)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.6731780616078136], [0.8925619834710743]], 0.18181818181818182)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.742612328777006], [0.9305172941536578]], 0.19191919191919193)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.8145942642422597], [0.9672482399755129]], 0.20202020202020204)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.8890001947853189], [1.002754820936639]], 0.21212121212121213)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[0.9657064471879289], [1.0370370370370372]], 0.22222222222222224)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.0445893482318338], [1.0700948882767065]], 0.23232323232323235)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.1255252246987784], [1.1019283746556474]], 0.24242424242424243)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.2083904033705075], [1.1325374961738597]], 0.25252525252525254)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.2930612110287658], [1.1619222528313438]], 0.26262626262626265)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.3794139744552971], [1.1900826446280994]], 0.27272727272727276)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.4673250204318469], [1.2170186715641262]], 0.2828282828282829)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.5566706757401583], [1.2427303336394246]], 0.29292929292929293)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.647327267161978], [1.2672176308539946]], 0.30303030303030304)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.7391711214790495], [1.290480563207836]], 0.31313131313131315)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.832078565473117], [1.3125191307009487]], 0.32323232323232326)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[1.925925925925926], [1.3333333333333333]], 0.33333333333333337)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.020589529619221], [1.3529231711049896]], 0.3434343434343435)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.1159457033347455], [1.3712886440159169]], 0.3535353535353536)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.211870773854245], [1.3884297520661155]], 0.36363636363636365)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.3082410679594645], [1.4043464952555864]], 0.37373737373737376)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.4049329124321477], [1.4190388735843282]], 0.38383838383838387)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.5018226340540393], [1.4325068870523412]], 0.393939393939394)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.5987865596068844], [1.4447505356596269]], 0.4040404040404041)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.6957010158724275], [1.4557698194061832]], 0.4141414141414142)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.792442329632413], [1.4655647382920107]], 0.42424242424242425)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.8888868276685846], [1.4741352923171107]], 0.43434343434343436)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[2.984910836762689], [1.4814814814814816]], 0.4444444444444445)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.080390683696469], [1.487603305785124]], 0.4545454545454546)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.1752026952516705], [1.4925007652280378]], 0.4646464646464647)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.269223198210037], [1.4961738598102234]], 0.4747474747474748)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.362328519353313], [1.4986225895316805]], 0.48484848484848486)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.4543949854632436], [1.4998469543924087]], 0.494949494949495)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.5452989233215746], [1.499846954392409]], 0.5050505050505051)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.6349166597100493], [1.4986225895316805]], 0.5151515151515152)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.7231245214104116], [1.4961738598102237]], 0.5252525252525253)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.809798835204406], [1.4925007652280378]], 0.5353535353535354)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.894815927873779], [1.4876033057851241]], 0.5454545454545455)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[3.9780521262002746], [1.4814814814814814]], 0.5555555555555556)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.059383756965637], [1.4741352923171105]], 0.5656565656565657)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.13868714695161], [1.4655647382920112]], 0.5757575757575758)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.215838622939939], [1.455769819406183]], 0.5858585858585859)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.29071451171237], [1.4447505356596264]], 0.595959595959596)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.363191140050644], [1.4325068870523416]], 0.6060606060606061)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.43314483473651], [1.419038873584328]], 0.6161616161616162)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.500451922551709], [1.4043464952555862]], 0.6262626262626263)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.564988730277987], [1.3884297520661155]], 0.6363636363636365)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.626631584697089], [1.3712886440159167]], 0.6464646464646465)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.685256812590758], [1.3529231711049892]], 0.6565656565656566)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.7407407407407405], [1.333333333333333]], 0.6666666666666667)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.792959695928781], [1.3125191307009487]], 0.6767676767676768)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.841790004936623], [1.2904805632078358]], 0.686868686868687)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.887107994546011], [1.2672176308539942]], 0.696969696969697)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.928789991538691], [1.2427303336394242]], 0.7070707070707072)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.966712322696406], [1.2170186715641258]], 0.7171717171717172)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.000751314800901], [1.190082644628099]], 0.7272727272727273)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.030783294633922], [1.1619222528313435]], 0.7373737373737375)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.0566845889772125], [1.1325374961738597]], 0.7474747474747475)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.0783315246125165], [1.101928374655647]], 0.7575757575757577)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.09560042832158], [1.0700948882767063]], 0.7676767676767677)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.108367626886146], [1.037037037037037]], 0.7777777777777778)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.116509447087959], [1.0027548209366388]], 0.787878787878788)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.119902215708766], [0.9672482399755126]], 0.797979797979798)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.11842225953031], [0.9305172941536575]], 0.8080808080808082)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.111945905334335], [0.8925619834710742]], 0.8181818181818182)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.100349479902587], [0.853382307927762]], 0.8282828282828284)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.083509310016809], [0.8129782675237217]], 0.8383838383838385)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.061301722458747], [0.7713498622589532]], 0.8484848484848485)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.033603044010145], [0.7284970921334554]], 0.8585858585858587)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[5.000289601452748], [0.6844199571472297]], 0.8686868686868687)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.9612377215683], [0.639118457300275]], 0.8787878787878789)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.9163237311385455], [0.5925925925925923]], 0.888888888888889)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.8654239569452296], [0.5448423630241805]], 0.8989898989898991)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.808414725770097], [0.49586776859504095]], 0.9090909090909092)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.745172364394893], [0.4456688093051728]], 0.9191919191919192)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.675573199601359], [0.3942454851545756]], 0.9292929292929294)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.599493558171243], [0.34159779614325037]], 0.9393939393939394)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.516809766886288], [0.2877257422711962]], 0.9494949494949496)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.427398152528241], [0.23262932353841406]], 0.9595959595959597)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.331135041878843], [0.17630853994490342]], 0.9696969696969697)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.2278967617198395], [0.11876339149066369]], 0.9797979797979799)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.117559638832978], [0.05999387817569608]], 0.98989898989899)
    , ([[0, 0, 8, 4], [0, 2, 2, 0]], [[4.0], [0.0]], 1.0)
]

cases_parallel = [
    ([[-23, -21, -18, -15, -12, -9, -6], [-3, -6, -8, -5, -4, -5, -7]],
     [[[-23.0], [-3.0]], [[-21.506729815727414], [-4.72844022196255]], [[-19.778622650491776], [-5.728084585118575]],
      [[-17.912208504801104], [-5.995884773662554]], [[-15.970598805888145], [-5.763851490569979]],
      [[-13.992292653370741], [-5.360864141080572]], [[-11.998628257887521], [-5.106995884773664]],
      [[-9.999879572708918], [-5.2403540562357795]], [[-7.999998118323578], [-5.8764359543204225]], [[-6.0], [-7.0]]],
     [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444,
      0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.])
    , ([[1, 5, 10, 14], [1, 6, 4, 2]],
       [[[1.0], [1.0]], [[2.367626886145404], [2.4170096021947867]], [[3.792866941015089], [3.3731138545953367]],
        [[5.2592592592592595], [3.925925925925927]], [[6.750342935528121], [4.133058984910837]],
        [[8.24965706447188], [4.0521262002743486]], [[9.74074074074074], [3.740740740740741]],
        [[11.207133058984908], [3.256515775034294]], [[12.632373113854596], [2.657064471879287]], [[14.0], [2.0]]],
       [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444,
        0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.])
    , ([[-12, -2], [-2, -6]],
       [[[-12.0], [-2.0]], [[-10.888888888888888], [-2.444444444444444]], [[-9.777777777777779], [-2.888888888888889]],
        [[-8.666666666666666], [-3.3333333333333335]], [[-7.555555555555555], [-3.7777777777777777]],
        [[-6.444444444444445], [-4.222222222222222]], [[-5.333333333333333], [-4.666666666666667]],
        [[-4.222222222222223], [-5.111111111111111]], [[-3.1111111111111116], [-5.555555555555555]], [[-2.0], [-6.0]]],
       [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444,
        0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.])
    , ([[-12, -2, 13], [-2, -6, -2]],
       [[[-12.0], [-2.0]], [[-9.716049382716049], [-2.790123456790123]], [[-7.3086419753086425], [-3.382716049382716]],
        [[-4.777777777777779], [-3.7777777777777786]], [[-2.1234567901234573], [-3.975308641975309]],
        [[0.6543209876543221], [-3.9753086419753085]], [[3.5555555555555554], [-3.7777777777777777]],
        [[6.580246913580243], [-3.3827160493827164]], [[9.728395061728394], [-2.790123456790124]], [[13.0], [-2.0]]],
       [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444,
        0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.])
    , ([[-12, -2, 7, 13], [-2, -6, -4, -2]],
       [[[-12.0], [-2.0]], [[-8.706447187928667], [-3.1193415637860076]], [[-5.503429355281209], [-3.843621399176955]],
        [[-2.4074074074074088], [-4.222222222222224]], [[0.5651577503429349], [-4.304526748971194]],
        [[3.397805212620028], [-4.139917695473251]], [[6.0740740740740735], [-3.777777777777778]],
        [[8.577503429355279], [-3.267489711934157]], [[10.891632373113856], [-2.65843621399177]], [[13.0], [-2.0]]],
       [0., 0.11111111, 0.22222222, 0.33333333, 0.44444444,
        0.55555556, 0.66666667, 0.77777778, 0.88888889, 1.])
    , ([[-12, -9, -2, 7, 13], [-2, -5, -6, -4, -2]], [[[-12.0], [-2.0]], [[-11.87634742517825], [-2.1199836755515995]],
                                                      [[-11.747847297429434], [-2.2374944697094876]],
                                                      [[-11.614550210342847], [-2.35250914689933]],
                                                      [[-11.476507507042424], [-2.465005470926326]],
                                                      [[-11.333771280186768], [-2.5749622049752223]],
                                                      [[-11.186394371969131], [-2.682359111610302]],
                                                      [[-11.03443037411742], [-2.7871769527753925]],
                                                      [[-10.877933627894208], [-2.889397489793863]],
                                                      [[-10.716959224096714], [-2.989003483368622]],
                                                      [[-10.551563003056824], [-3.0859786935821227]],
                                                      [[-10.38180155464106], [-3.180307879896357]],
                                                      [[-10.207732218250623], [-3.271976801152859]],
                                                      [[-10.029413082821364], [-3.3609722155727053]],
                                                      [[-9.846902986823775], [-3.4472818807565107]],
                                                      [[-9.660261518263022], [-3.5308945536844365]],
                                                      [[-9.469549014678917], [-3.6117999907161806]],
                                                      [[-9.274826563145938], [-3.6899889475909866]],
                                                      [[-9.076156000273203], [-3.765453179427635]],
                                                      [[-8.87359991220451], [-3.838185440724452]],
                                                      [[-8.667221634618285], [-3.9081794853593044]],
                                                      [[-8.457085252727625], [-3.975430066589596]],
                                                      [[-8.243255601280294], [-4.039932937052278]],
                                                      [[-8.025798264558686], [-4.101684848763841]],
                                                      [[-7.804779576379877], [-4.160683553120317]],
                                                      [[-7.5802666200955775], [-4.2169278008972775]],
                                                      [[-7.3523272285921735], [-4.270417342249839]],
                                                      [[-7.121029984290691], [-4.321152926712657]],
                                                      [[-6.886444219146817], [-4.369136303199927]],
                                                      [[-6.648640014650905], [-4.41437022000539]],
                                                      [[-6.407688201827947], [-4.456858424802328]],
                                                      [[-6.1636603612376035], [-4.496605664643558]],
                                                      [[-5.916628822974184], [-4.533617685961448]],
                                                      [[-5.666666666666665], [-4.567901234567901]],
                                                      [[-5.413847721478668], [-4.599464055654365]],
                                                      [[-5.158246566108473], [-4.628314893791824]],
                                                      [[-4.899938528789017], [-4.6544634929308115]],
                                                      [[-4.638999687287895], [-4.677920596401395]],
                                                      [[-4.3755068689073555], [-4.698697946913188]],
                                                      [[-4.109537650484305], [-4.7168082865553425]],
                                                      [[-3.841170358390307], [-4.7322653567965585]],
                                                      [[-3.5704840685315773], [-4.745083898485067]],
                                                      [[-3.2975586063489883], [-4.755279651848647]],
                                                      [[-3.022474546818073], [-4.76286935649462]],
                                                      [[-2.745313214449017], [-4.767870751409847]],
                                                      [[-2.4661566832866595], [-4.770302574960726]],
                                                      [[-2.1850877769105006], [-4.7701845648932055]],
                                                      [[-1.9021900684346993], [-4.767537458332771]],
                                                      [[-1.6175478805080599], [-4.762382991784444]],
                                                      [[-1.3312462853140508], [-4.754743901132797]],
                                                      [[-1.0433711045707958], [-4.74464392164194]],
                                                      [[-0.7540089095310707], [-4.732107787955522]],
                                                      [[-0.46324702098231507], [-4.717161234096735]],
                                                      [[-0.17117350924661845], [-4.699830993468315]],
                                                      [[0.1221228058192767], [-4.680144798852537]],
                                                      [[0.41655235482396125], [-4.658131382411217]],
                                                      [[0.7120248188413804], [-4.633820475685715]],
                                                      [[1.0084491294108133], [-4.6072428095969284]],
                                                      [[1.3057334685368929], [-4.578430114445302]],
                                                      [[1.6037852686895941], [-4.547415119910814]],
                                                      [[1.9025112128042263], [-4.514231555052992]],
                                                      [[2.201817234281456], [-4.4789141483109]],
                                                      [[2.501608516987283], [-4.441498627503148]],
                                                      [[2.8017894952530593], [-4.40202171982788]],
                                                      [[3.1022638538754723], [-4.360521151862789]],
                                                      [[3.4029345281165604], [-4.317035649565107]],
                                                      [[3.703703703703706], [-4.271604938271604]],
                                                      [[4.004472816829628], [-4.224269742698598]],
                                                      [[4.305142554152399], [-4.175071786941942]],
                                                      [[4.605612852795424], [-4.124053794477035]],
                                                      [[4.9057829003474644], [-4.071259488158814]],
                                                      [[5.205551134862616], [-4.016733590221762]],
                                                      [[5.504815244860325], [-3.9605218222798984]],
                                                      [[5.803472169325378], [-3.9026709053267874]],
                                                      [[6.101418097707902], [-3.8432285597355325]],
                                                      [[6.398548469923379], [-3.7822435052587813]],
                                                      [[6.694757976352619], [-3.7197654610287207]],
                                                      [[6.989940557841793], [-3.6558451455570795]],
                                                      [[7.283989405702405], [-3.5905342767351276]],
                                                      [[7.5767969617113025], [-3.5238855718336777]],
                                                      [[7.8682549181106864], [-3.4559527475030833]],
                                                      [[8.158254217608087], [-3.386790519773239]],
                                                      [[8.446685053376395], [-3.3164546040535803]],
                                                      [[8.733436869053833], [-3.2450017151330868]],
                                                      [[9.018398358743964], [-3.1724895671802757]],
                                                      [[9.301457467015716], [-3.098976873743208]],
                                                      [[9.582501388903335], [-3.024523347749487]],
                                                      [[9.861416569906432], [-2.9491897015062545]],
                                                      [[10.138088705989942], [-2.8730376467001975]],
                                                      [[10.412402743584165], [-2.796129894397541]],
                                                      [[10.684242879584732], [-2.7185301550440535]],
                                                      [[10.953492561352615], [-2.640303138465045]],
                                                      [[11.220034486714141], [-2.561514553865365]],
                                                      [[11.483750603960974], [-2.4822311098294065]],
                                                      [[11.744522111850124], [-2.4025205143211026]],
                                                      [[12.002229459603942], [-2.3224514746839304]],
                                                      [[12.256752346910122], [-2.242093697640905]],
                                                      [[12.507969723921716], [-2.161517889294584]],
                                                      [[12.755759791257098], [-2.080795755127069]], [[13.0], [-2.0]]],
       [0., 0.01010101, 0.02020202, 0.03030303, 0.04040404,
        0.05050505, 0.06060606, 0.07070707, 0.08080808, 0.09090909,
        0.1010101, 0.11111111, 0.12121212, 0.13131313, 0.14141414,
        0.15151515, 0.16161616, 0.17171717, 0.18181818, 0.19191919,
        0.2020202, 0.21212121, 0.22222222, 0.23232323, 0.24242424,
        0.25252525, 0.26262626, 0.27272727, 0.28282828, 0.29292929,
        0.3030303, 0.31313131, 0.32323232, 0.33333333, 0.34343434,
        0.35353535, 0.36363636, 0.37373737, 0.38383838, 0.39393939,
        0.4040404, 0.41414141, 0.42424242, 0.43434343, 0.44444444,
        0.45454545, 0.46464646, 0.47474747, 0.48484848, 0.49494949,
        0.50505051, 0.51515152, 0.52525253, 0.53535354, 0.54545455,
        0.55555556, 0.56565657, 0.57575758, 0.58585859, 0.5959596,
        0.60606061, 0.61616162, 0.62626263, 0.63636364, 0.64646465,
        0.65656566, 0.66666667, 0.67676768, 0.68686869, 0.6969697,
        0.70707071, 0.71717172, 0.72727273, 0.73737374, 0.74747475,
        0.75757576, 0.76767677, 0.77777778, 0.78787879, 0.7979798,
        0.80808081, 0.81818182, 0.82828283, 0.83838384, 0.84848485,
        0.85858586, 0.86868687, 0.87878788, 0.88888889, 0.8989899,
        0.90909091, 0.91919192, 0.92929293, 0.93939394, 0.94949495,
        0.95959596, 0.96969697, 0.97979798, 0.98989899, 1.])
]


@pytest.mark.parametrize('m, res, t', cases_de_caes)
def test_parametrized_for_de_caes(m, res, t):
    tmp = de_caes(np.array(m, dtype=float), t)
    assert res == [pytest.approx(list(tmp[0])), pytest.approx(list(tmp[1]))]


@pytest.mark.parametrize('m, res, ts', cases_parallel)
def test_parametrized_for_de_caes(m, res, ts):
    tmp = list(parallel_decaes_unblossomed(np.array(m, dtype=float), ts))
    tmp = [[pytest.approx(list(t[0])), pytest.approx(list(t[1]))] for t in tmp]
    assert res == tmp
